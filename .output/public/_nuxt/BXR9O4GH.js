import{d as G,B as K,z as V,r as d,Q,o as X,s as S,y as Z,c as m,e as c,f as e,X as C,g as r,j as W,U as y,C as Y,w as M,aH as ee,b as v,ai as le,n as te,_ as oe,a6 as ae}from"./IEdULTv5.js";import{_ as se}from"./PljlzN2g.js";import{_ as re}from"./C5D-PoO-.js";import{u as ie}from"./Bdg8mEWQ.js";/* empty css        */import"./DnbjhcHz.js";const ue={class:"relative"},ne={class:"bg-muted-100 dark:bg-muted-900 flex min-h-screen"},de={class:"relative w-full p-4 sm:p-8"},me={class:"flex w-full flex-col"},ce=e("div",{class:"flex h-16 w-full items-center justify-between px-4 sm:px-8"},[e("h1",{class:"text-2xl font-bold"}," ویرایش پروفایل ")],-1),fe={class:"nui-slimscroll relative h-[calc(100vh_-_128px)] w-full overflow-y-auto p-4 sm:p-8"},ve={class:"mt-12 space-y-4"},pe={class:"mb-6"},be=e("h2",{class:"mb-2 text-xl font-semibold"}," اطلاعات شخصی ",-1),ge={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},_e=e("label",{for:"firstName",class:"block text-sm font-medium"},"نام",-1),he={key:0,class:"text-sm text-red-500"},xe=e("label",{for:"lastName",class:"block text-sm font-medium"},"نام خانوادگی",-1),ye={key:0,class:"text-sm text-red-500"},we=e("label",{for:"role",class:"block text-sm font-medium"},"عنوان شغلی",-1),ke={key:0,class:"text-sm text-red-500"},Ve=e("label",{for:"referralCode",class:"block text-sm font-medium"},"کد معرف",-1),Ce={key:0,class:"text-muted-500 mt-1 text-xs"},Ne={key:1,class:"text-muted-500 mt-1 text-xs"},Ue=e("label",{for:"inviteCode",class:"block text-sm font-medium"},"دیگران را دعوت کنید",-1),je=e("p",{class:"text-muted-500 mt-1 text-xs"}," این کد را با دوستان خود به اشتراک بگذارید تا اعتبار دریافت کنید. ",-1),Be=e("label",{for:"avatar",class:"block text-sm font-medium"},"تصویر پروفایل",-1),Se={key:0,class:"relative mt-2"},Me=["src"],Ie={class:"mb-6"},Je=e("h2",{class:"mb-2 text-xl font-semibold"}," اطلاعات تماس و توضیحات ",-1),Pe={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},ze=e("label",{for:"location",class:"block text-sm font-medium"},"محل سکونت",-1),Re=e("label",{for:"bio",class:"block text-sm font-medium"},"بیوگرافی",-1),Te={class:"mb-6"},Fe=e("h2",{class:"mb-2 text-xl font-semibold"}," اطلاعات شغلی و ترجیحات ",-1),Oe={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Le=e("label",{for:"experience",class:"block text-sm font-medium"},"سابقه کاری",-1),Ee=e("label",{for:"firstJob",class:"block text-sm font-medium"},"آیا این اولین شغل شماست؟",-1),$e=e("option",{value:null}," انتخاب کنید ",-1),Ae=e("option",{value:!0}," بله ",-1),De=e("option",{value:!1}," خیر ",-1),qe=e("label",{for:"flexible",class:"block text-sm font-medium"},"انعطاف‌پذیری در برنامه کاری",-1),He=e("option",{value:null}," انتخاب کنید ",-1),Ge=e("option",{value:!0}," بله ",-1),Ke=e("option",{value:!1}," خیر ",-1),Qe=e("label",{for:"remote",class:"block text-sm font-medium"},"مایل به دورکاری هستید؟",-1),Xe=e("option",{value:null}," انتخاب کنید ",-1),Ze=e("option",{value:!0}," بله ",-1),We=e("option",{value:!1}," خیر ",-1),Ye={class:"mb-6"},el=e("h2",{class:"mb-2 text-xl font-semibold"}," شبکه‌های اجتماعی ",-1),ll={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},tl=e("label",{for:"facebook",class:"block text-sm font-medium"},"فیسبوک",-1),ol=e("label",{for:"twitter",class:"block text-sm font-medium"},"توئیتر",-1),al=e("label",{for:"dribbble",class:"block text-sm font-medium"},"دریبل",-1),sl=e("label",{for:"instagram",class:"block text-sm font-medium"},"اینستاگرام",-1),rl=e("label",{for:"github",class:"block text-sm font-medium"},"گیت‌هاب",-1),il=e("label",{for:"gitlab",class:"block text-sm font-medium"},"گیت‌لب",-1),ul={class:"flex justify-end"},nl=["disabled"],dl={key:0},ml={key:1},hl=G({__name:"index",async setup(cl){let w,I;const T=K(),N=ie(),p=V(()=>N.user?.id??null),b=d(!1),x=d(!1),i=d(null),f=d(null),k=d(null),g=d(null),U=d(0),l=d({firstName:"",lastName:"",role:"",location:"",bio:"",referralCode:"",experience:"",firstJob:null,flexible:null,remote:null,facebook:"",twitter:"",dribbble:"",instagram:"",github:"",gitlab:"",profilePicture:"/img/avatars/default-other.jpg"}),_=d(""),h=d(!1),J=d(!1),F={personalInfo:{firstName:"",lastName:"",role:"",picture:"/img/avatars/default-other.jpg",referralCode:null,credit:0},profile:{firstName:"",lastName:"",role:"",location:null,bio:null,referralCode:null,credit:0},info:{experience:null,firstJob:null,flexible:null,remote:null},social:{facebook:null,twitter:null,dribbble:null,instagram:null,github:null,gitlab:null},settings:{twoFactor:{enabled:!1,phoneNumber:null},notifications:{enabled:!0,flushLowPriority:!0,marketing:!1,partners:!1}}},O=V(()=>g.value?.name||"انتخاب تصویر"),L=V(()=>!!f.value),E=V(()=>f.value||a.value?.personalInfo?.picture||"/img/placeholder.png");let P=null;const{data:a,error:z,refresh:j}=([w,I]=Q(async()=>ee("profile",async()=>{if(!p.value)return P??F;const s=await $fetch("/api/profile",{method:"GET",query:{userId:p.value.toString()},credentials:"include"});return P=s,s},{default:()=>({}),watch:[p],server:!1})),w=await w,I(),w);X(async()=>{if(!await N.checkAuth()){await T.push("/auth");return}p.value&&await j({dedupe:!1})}),S(()=>N.user,()=>{},{immediate:!0,deep:!0}),S(p,async s=>{s&&await j({dedupe:!1})},{immediate:!0}),Z(()=>{if(z.value)i.value=z.value?.message||"خطا در بارگذاری اطلاعات پروفایل",v.error({title:"خطا",message:i.value});else if(a.value&&Object.keys(a.value).length>0){const s=a.value.profile?.referredByCode??a.value.personalInfo?.referredByCode??"";Object.assign(l.value,{firstName:a.value.profile?.firstName??"",lastName:a.value.profile?.lastName??"",role:a.value.profile?.role??"",location:a.value.profile?.location??"",bio:a.value.profile?.bio??"",referralCode:s,experience:a.value.info?.experience??"",firstJob:a.value.info?.firstJob??null,flexible:a.value.info?.flexible??null,remote:a.value.info?.remote??null,facebook:a.value.social?.facebook??"",twitter:a.value.social?.twitter??"",dribbble:a.value.social?.dribbble??"",instagram:a.value.social?.instagram??"",github:a.value.social?.github??"",gitlab:a.value.social?.gitlab??"",profilePicture:a.value.personalInfo?.picture??"/img/avatars/default-other.jpg"}),_.value=a.value.personalInfo?.referralCode??a.value.profile?.referralCode??_.value,h.value=s.trim().length>0,J.value||(J.value=!0,U.value+=1)}});const $=async s=>{const t=s.target;if(!t.files||t.files.length===0)return;const n=t.files[0],u=5*1024*1024;if(!["image/jpeg","image/png","image/gif"].includes(n.type)){v.warning({title:"خطا در انتخاب فایل",message:"نوع فایل "+n.name+" پشتیبانی نمی‌شود"});return}if(n.size>u){v.warning({title:"خطا در انتخاب فایل",message:"حجم فایل "+n.name+" نباید بیشتر از ۵ مگابایت باشد"});return}g.value=n,f.value=URL.createObjectURL(n)},A=()=>{f.value&&URL.revokeObjectURL(f.value),g.value=null,f.value=null,k.value&&(k.value.value="")};S(()=>l.value.referralCode,s=>{if(h.value||typeof s!="string")return;const t=s.toUpperCase().replace(/[^A-Z0-9]/g,"");t!==s&&(l.value.referralCode=t)});const D=()=>l.value.firstName.trim()?l.value.lastName.trim()?l.value.role.trim()?!0:(i.value="عنوان شغلی را وارد کنید.",v.error({title:"خطا",message:i.value}),!1):(i.value="نام خانوادگی را وارد کنید.",v.error({title:"خطا",message:i.value}),!1):(i.value="نام را وارد کنید.",v.error({title:"خطا",message:i.value}),!1),q=async()=>{if(!D()){document.documentElement.scrollTo({top:0,behavior:"smooth"});return}b.value=!0,x.value=!1,i.value=null;try{const s=new FormData;s.append("profile",JSON.stringify({firstName:l.value.firstName,lastName:l.value.lastName,role:l.value.role,location:l.value.location||null,bio:l.value.bio||null,referralCode:l.value.referralCode||null})),s.append("info",JSON.stringify({experience:l.value.experience||null,firstJob:l.value.firstJob,flexible:l.value.flexible,remote:l.value.remote})),s.append("social",JSON.stringify({facebook:l.value.facebook||null,twitter:l.value.twitter||null,dribbble:l.value.dribbble||null,instagram:l.value.instagram||null,github:l.value.github||null,gitlab:l.value.gitlab||null})),s.append("userId",p.value?.toString()||""),g.value&&s.append("avatar",g.value);const t=await $fetch("/api/profile",{method:"POST",body:s,query:{userId:p.value?.toString()},credentials:"include"});let n;t&&typeof t=="object"&&("referredByCode"in t&&(n=String(t.referredByCode??""),l.value.referralCode=n),"referralCode"in t&&(_.value=String(t.referralCode??_.value??"")));const u=n??l.value.referralCode??"";h.value=u.trim().length>0,v.success({title:"موفقیت",message:"پروفایل با موفقیت به‌روزرسانی شد."}),await j({dedupe:!1}),await ae(),U.value+=1,f.value&&(URL.revokeObjectURL(f.value),f.value=null,g.value=null),x.value=!0,document.documentElement.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{x.value=!1},3e3)}catch(s){i.value=s.message||"خطا در به‌روزرسانی پروفایل",v.error({title:"خطا",message:i.value||""});const t=a.value?.profile?.referredByCode??a.value?.personalInfo?.referredByCode??"";h.value=t.trim().length>0,document.documentElement.scrollTo({top:0,behavior:"smooth"})}finally{b.value=!1}};return(s,t)=>{const n=le,u=te,R=oe,H=se,B=re;return m(),c("div",ue,[e("div",ne,[e("div",de,[e("div",me,[ce,e("div",fe,[e("div",{class:C(["bg-muted-100 dark:bg-muted-900 pointer-events-none absolute inset-0 z-10 size-full p-8 transition-opacity duration-300",b.value?"opacity-100":"opacity-0 pointer-events-none"])},[e("div",ve,[r(n,{class:"h-10 w-full max-w-md rounded"}),r(n,{class:"h-10 w-full max-w-md rounded"}),r(n,{class:"h-10 w-full max-w-md rounded"})])],2),b.value?y("",!0):(m(),c("form",{key:U.value,onSubmit:W(q,["prevent"])},[e("div",pe,[be,e("div",ge,[e("div",null,[_e,r(u,{id:"firstName",modelValue:l.value.firstName,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.firstName=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"},class:C({"border-red-500":i.value&&!l.value.firstName.trim()})},null,8,["modelValue","class"]),i.value&&!l.value.firstName.trim()?(m(),c("span",he,"نام را وارد کنید.")):y("",!0)]),e("div",null,[xe,r(u,{id:"lastName",modelValue:l.value.lastName,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.lastName=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"},class:C({"border-red-500":i.value&&!l.value.lastName.trim()})},null,8,["modelValue","class"]),i.value&&!l.value.lastName.trim()?(m(),c("span",ye,"نام خانوادگی را وارد کنید.")):y("",!0)]),e("div",null,[we,r(u,{id:"role",modelValue:l.value.role,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.role=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"},class:C({"border-red-500":i.value&&!l.value.role.trim()})},null,8,["modelValue","class"]),i.value&&!l.value.role.trim()?(m(),c("span",ke,"عنوان شغلی را وارد کنید.")):y("",!0)]),e("div",null,[Ve,r(u,{id:"referralCode",modelValue:l.value.referralCode,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.referralCode=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",maxlength:"32",autocomplete:"off",disabled:b.value||h.value,classes:{wrapper:"h-10"}},null,8,["modelValue","disabled"]),h.value?(m(),c("p",Ne," کد معرف شما ثبت شده و امکان تغییر آن وجود ندارد. ")):(m(),c("p",Ce," لطفاً فقط از حروف و اعداد انگلیسی استفاده کنید. "))]),e("div",null,[Ue,r(u,{id:"inviteCode",modelValue:_.value,"onUpdate:modelValue":t[4]||(t[4]=o=>_.value=o),type:"text",rounded:"lg",readonly:"",autocomplete:"off",classes:{wrapper:"h-10"}},null,8,["modelValue"]),je]),e("div",null,[Be,e("input",{id:"avatar",ref_key:"fileInput",ref:k,type:"file",class:"hidden",accept:"image/jpeg,image/png,image/gif",onChange:$},null,544),e("button",{type:"button",class:"flex h-10 w-full items-center justify-center rounded-lg border border-gray-300 bg-white text-sm",onClick:t[5]||(t[5]=o=>k.value?.click())},Y(O.value),1),L.value?(m(),c("div",Se,[e("img",{src:E.value,alt:"Profile Picture",class:"size-24 rounded-full object-cover"},null,8,Me),e("button",{type:"button",class:"absolute right-0 top-0 flex size-5 items-center justify-center rounded-full bg-red-500 text-white",onClick:A},[r(R,{name:"lucide:x",class:"size-3"})])])):y("",!0)])])]),e("div",Ie,[Je,e("div",Pe,[e("div",null,[ze,r(u,{id:"location",modelValue:l.value.location,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.location=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])]),e("div",null,[Re,r(H,{id:"bio",modelValue:l.value.bio,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.bio=o),modelModifiers:{trim:!0},rounded:"lg",classes:{textarea:"h-24"}},null,8,["modelValue"])])])]),e("div",Te,[Fe,e("div",Oe,[e("div",null,[Le,r(u,{id:"experience",modelValue:l.value.experience,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.experience=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])]),e("div",null,[Ee,r(B,{id:"firstJob",modelValue:l.value.firstJob,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.firstJob=o),rounded:"lg",classes:{wrapper:"h-10"}},{default:M(()=>[$e,Ae,De]),_:1},8,["modelValue"])]),e("div",null,[qe,r(B,{id:"flexible",modelValue:l.value.flexible,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.flexible=o),rounded:"lg",classes:{wrapper:"h-10"}},{default:M(()=>[He,Ge,Ke]),_:1},8,["modelValue"])]),e("div",null,[Qe,r(B,{id:"remote",modelValue:l.value.remote,"onUpdate:modelValue":t[11]||(t[11]=o=>l.value.remote=o),rounded:"lg",classes:{wrapper:"h-10"}},{default:M(()=>[Xe,Ze,We]),_:1},8,["modelValue"])])])]),e("div",Ye,[el,e("div",ll,[e("div",null,[tl,r(u,{id:"facebook",modelValue:l.value.facebook,"onUpdate:modelValue":t[12]||(t[12]=o=>l.value.facebook=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])]),e("div",null,[ol,r(u,{id:"twitter",modelValue:l.value.twitter,"onUpdate:modelValue":t[13]||(t[13]=o=>l.value.twitter=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])]),e("div",null,[al,r(u,{id:"dribbble",modelValue:l.value.dribbble,"onUpdate:modelValue":t[14]||(t[14]=o=>l.value.dribbble=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])]),e("div",null,[sl,r(u,{id:"instagram",modelValue:l.value.instagram,"onUpdate:modelValue":t[15]||(t[15]=o=>l.value.instagram=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])]),e("div",null,[rl,r(u,{id:"github",modelValue:l.value.github,"onUpdate:modelValue":t[16]||(t[16]=o=>l.value.github=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])]),e("div",null,[il,r(u,{id:"gitlab",modelValue:l.value.gitlab,"onUpdate:modelValue":t[17]||(t[17]=o=>l.value.gitlab=o),modelModifiers:{trim:!0},type:"text",rounded:"lg",classes:{wrapper:"h-10"}},null,8,["modelValue"])])])]),e("div",ul,[e("button",{type:"submit",class:"bg-primary-500 hover:bg-primary-600 flex h-10 items-center justify-center rounded-lg px-4 text-white transition-colors duration-300",disabled:b.value||x.value},[x.value?(m(),c("span",dl,"ذخیره شد!")):(m(),c("span",ml,"ذخیره تغییرات"))],8,nl)])],32))])])])])])}}});export{hl as default};
