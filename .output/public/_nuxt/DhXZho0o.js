import{as as _,H as f,P as k,s as v,bk as I,a8 as y,d as S,B as T,r as C,aw as A,z as B,a6 as N,c as d,e as m,i as g,f as u,R,S as j,X as $,j as q,C as E,N as L,U as M,ax as V}from"./IEdULTv5.js";const z=(x,l)=>{const i=_(x),o=_(l),r=f(),n=f([]),c=f([]),h=k();let a;const p=e=>{for(const s of e){const b=s.target.id;s.isIntersecting?n.value.push(b):n.value=n.value.filter(w=>w!==b)}},t=e=>{r.value?.disconnect();for(const s of e)r.value?.observe(s)};return v(n,(e,s)=>{c.value=e.length===0?s:e}),I(()=>{r.value=new IntersectionObserver(p,i.value)}),v([()=>h.path,o],()=>{o.value?.length&&(a&&clearTimeout(a),a=setTimeout(()=>{if(o.value?.length){const e=document.querySelectorAll(o.value.join(", "));t([...e])}},300))},{immediate:!0}),y(()=>{a&&clearTimeout(a),r.value?.disconnect()}),{visibleIds:n,activeIds:c,updateElements:t}},D={class:"flex flex-col justify-between"},F={key:0,class:"w-52"},P=u("div",{class:"font-heading text-muted-800 mb-6 text-xs font-semibold uppercase leading-tight dark:text-white"},[u("span",null,"در این صفحه")],-1),U={class:"nui-slimscroll-opaque relative max-h-[calc(100vh_-_220px)] overflow-y-auto overflow-x-hidden pb-10 font-sans text-[0.8rem] font-medium"},H=["href","onClick"],X=S({__name:"TairoToc",setup(x){const l=k();T();const i=C(""),o=A("tairo-toc",()=>[]),r=B(()=>o.value.map(({id:t})=>`#${t}`)),{activeIds:n}=z({rootMargin:"0px 0px -90% 0px"},()=>r.value),c=V();{v(()=>l.hash,()=>{l.hash&&(i.value=l.hash.slice(1))},{immediate:!0});const t=c.hook("page:finish",s=>{a()}),e=c.hook("page:transition:finish",s=>{a()});y(()=>{t(),e()})}function h(t){const e=["pe-3"];return t.level>2&&e.push("ms-3 text-xs"),i.value===t.id?e.push("border-primary-500 text-primary-500"):n.value.includes(t.id)?e.push("border-primary-400 dark:border-primary-600 text-muted-500 dark:text-muted-400 dark:hover:text-muted-300 hover:text-muted-400"):e.push("border-muted-200 dark:border-muted-800 text-muted-500 dark:text-muted-400 dark:hover:text-muted-300 hover:text-muted-400"),e}async function a(){await N();const t=document.querySelectorAll(".tairo-toc-anchor");o.value=Array.from(t).map(e=>({id:e.getAttribute("id"),level:("dataset"in e&&e.dataset?.tocLevel)??2,label:"dataset"in e&&e.dataset?.tocLabel}))}function p(t){const e=document.getElementById(t);e&&(e?.focus({preventScroll:!0}),e?.scrollIntoView({behavior:"smooth"}),window.history.pushState({},"",`#${t}`),i.value=t)}return(t,e)=>(d(),m("div",D,[g(o).length?(d(),m("div",F,[P,u("nav",U,[u("ul",null,[(d(!0),m(R,null,j(g(o),s=>(d(),m("li",{key:s.id},[u("a",{href:`#${s.id}`,class:$(["block border-e-2 py-1",h(s)]),onClick:q(()=>p(s.id),["prevent"])},E(s.label),11,H)]))),128))]),L(t.$slots,"nav-end")])])):M("",!0)]))}});export{X as _};
