import{d as ee,an as te,ao as ne,z as A,r as le,s as se,x as re,F as ie,aq as ae,c as d,e as b,i as n,N as u,f as $,J as c,K as f,O as M,X as I,U as C,C as D,R as K,S as oe,I as X,W as G,a5 as ue,aD as ce,A as fe,g as pe,w as g,_ as de,M as me}from"./IEdULTv5.js";import{_ as ve}from"./BuxtxGPb.js";const ye={class:"treeview relative w-full"},he={key:0},ge={class:"text-muted-400 dark:text-muted-600 relative z-10 flex items-center gap-1 py-2 font-sans text-sm"},ke={class:"text-muted-400 flex size-5 items-center justify-center"},be={key:1},$e={class:"text-muted-400 dark:text-muted-600 relative z-10 flex items-center gap-1 py-2 font-sans text-sm"},Ce={class:"text-muted-400 flex size-5 items-center justify-center"},Se={class:"text-muted-700 dark:text-muted-400 relative z-10 flex items-center gap-1 py-2 font-sans text-sm"},ze=["onClick"],Me={class:"text-muted-400 me-1 flex size-5 items-center justify-center"},we={key:0,class:"relative"},Ie=ee({__name:"BaseTreeSelect",props:te({children:{type:[Array,Function],default:void 0},icons:{default:()=>({open:"lucide:minus",closed:"lucide:plus",item:"",pending:"",empty:""})},treeline:{type:[Boolean,Object],default:!1},i18n:{default:()=>({pending:"pending...",empty:"empty"})},classes:{default:()=>({pendingIcon:"",emptyIcon:"",treeIcon:"",itemIcon:"",treeline:"border-muted-300 dark:border-muted-700",checkbox:{wrapper:"text-primary-500 scale-[0.8] me-1"}})},level:{default:1},parent:{default:void 0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(T,{expose:H}){const i=T,[v]=ne(T,"modelValue"),U={open:"lucide:minus",closed:"lucide:plus",item:"",empty:"",pending:""},k=A(()=>i.icons?{...U,...i.icons}:U),F={offset:"0.625rem",minLevel:1},L=A(()=>i.treeline===!1?!1:i.treeline===!0?F:{...F,...i.treeline}),P={wrapper:"text-primary-500 scale-[0.8] me-1"},R=A(()=>i.classes?.checkbox?{...P,...i.classes.checkbox}:P),S=Y(),w=A(()=>i.children?S?.treeMap.get(i.children):void 0),p=le(W(i.children)),N=A(()=>w.value?.tree);se(()=>i.children,Q,{immediate:!0}),H({tree:N,loadTree:q,getChildren:_,getNodeChildren:h,areAllChildSelected:V,areSomeChildSelected:j,selectAllNode:B,unselectAllNode:O,isUndeterminate:E,isNodeLoaded:y,toggleNodeSelection:z,toggleChildrenSelection:J,selectAllChildren:Z,unselectAllChildren:x});async function Q(){S.treeMap=new WeakMap,i.children&&S.treeMap.set(i.children,{tree:[],pending:!1,loaded:!1}),await q(i.children),p.value=W(i.children)}function Y(){const e=Symbol("tree");let t=re(e,null);return t||(t=ie({treeMap:new WeakMap}),ae(e,t)),t}function W(e){const t={},r=_(e);if(!r)return t;for(const l in r){const m=r[l];"open"in m&&m.open!==void 0&&(t[l]=m.open)}return t}async function q(e){if(!e)return;const t=S?.treeMap.get(e);if(t){if(typeof e=="function"){t.pending=!0;try{t.tree=await e()}finally{t.pending=!1,t.loaded=!0}return}t.tree=e??[],t.loaded=!0}}function y(e){return e?"children"in e&&typeof e.children=="function"?S?.treeMap.get(e.children)?.loaded??!1:!0:!1}function _(e){if(e)return S?.treeMap.has(e)?S?.treeMap.get(e)?.tree:Array.isArray(e)?e:void 0}function h(e){if(e&&!(!("children"in e)||!e.children))return _(e.children)}function V(e){const t=v.value;if(!t||!e)return!1;const r=h(e);return r?y(e)&&r.every(l=>"children"in l?h(l)&&y(l)?V(l):!1:t.includes(l)):!1}function j(e){const t=v.value;if(!t||!e)return!1;const r=h(e);return r?y(e)&&r.some(l=>"children"in l?h(l)&&y(l)?j(l):!1:t.includes(l)):!1}function E(e){return!e||!y(e)?!1:j(e)&&!V(e)}function B(e){const t=v.value;if(!t||!e)return;if(!("children"in e)||!e.children){t.indexOf(e)===-1&&t.push(e);return}if(!y(e))return;const r=h(e);if(r)for(const l of r)"children"in l?B(l):t.indexOf(l)===-1&&t.push(l)}function Z(e){const t=e||N.value;if(t)for(const r of t)B(r)}function O(e){const t=v.value;if(!t||!e)return;if(!("children"in e)||!e.children){const l=t.indexOf(e);l>=0&&t.splice(l,1);return}if(!y(e))return;const r=h(e);if(r)for(const l of r)if("children"in l)O(l);else{const m=t.indexOf(l);m>=0&&t.splice(m,1)}}function x(e){const t=e||N.value;if(t)for(const r of t)O(r)}function z(e,t){const r=v.value;if(!r||!e)return;if("children"in e){if(!y(e)){t?.preventDefault();return}const m=h(e);if(!m||m.length===0){t?.preventDefault();return}V(e)?O(e):m.length>0&&B(e);return}const l=r.indexOf(e);l>=0?r.splice(l,1):r.push(e)}function J(e,t){const r=e||N.value;if(r)for(const l of r)"children"in l?J(h(l),t):z(l,t)}return(e,t)=>{const r=de,l=ve,m=Ve;return d(),b("ul",ye,[n(w)?.pending?(d(),b("li",he,[u(e.$slots,"pending",c(f({level:e.level,parent:e.parent})),()=>[$("div",ge,[u(e.$slots,"pending-icon",c(f({level:e.level,parent:e.parent})),()=>[$("span",ke,[n(k).pending?(d(),M(r,{key:0,name:n(k).pending,class:I(["size-4",i.classes?.pendingIcon])},null,8,["name","class"])):C("",!0)])],!0),u(e.$slots,"pending-label",c(f({level:e.level,parent:e.parent})),()=>[$("span",null,D(i.i18n.pending),1)],!0)])],!0)])):n(w)?.tree?.length?(d(!0),b(K,{key:2},oe(n(w).tree,(a,o)=>(d(),b("li",{key:o},[u(e.$slots,"item",c(f({index:o,level:e.level,child:a,parent:e.parent,toggle:()=>n(p)[o]=!n(p)[o],open:n(p)[o]})),()=>[$("div",Se,["children"in a?(d(),b("button",{key:0,class:"text-muted-400 nui-focus me-1 flex size-5 items-center justify-center rounded",onClick:s=>n(p)[o]=!n(p)[o]},[n(p)[o]&&n(k).open?(d(),M(r,{key:0,name:n(k).open,class:I(["size-4",i.classes?.treeIcon])},null,8,["name","class"])):!n(p)[o]&&n(k).closed?(d(),M(r,{key:1,name:n(k).closed,class:I(["size-4",i.classes?.treeIcon])},null,8,["name","class"])):C("",!0)],8,ze)):u(e.$slots,"item-icon",c(X({key:1},{index:o,level:e.level,child:a,parent:e.parent,toggle:s=>{if("children"in a){n(p)[o]=!n(p)[o];return}z(a,s)},open:n(p)[o]})),()=>[$("span",Me,[n(k).item?(d(),M(r,{key:0,name:n(k).item,class:I([i.classes?.itemIcon,"size-4"])},null,8,["name","class"])):C("",!0)])],!0),n(v)!==void 0?u(e.$slots,"item-select",c(X({key:2},{index:o,level:e.level,child:a,parent:e.parent,toggle:s=>{if("children"in a){n(p)[o]=!n(p)[o];return}z(a,s)},open:n(p)[o]})),()=>["children"in a?(d(),M(l,{key:0,"model-value":y(a)&&h(a)?.length&&V(a),indeterminate:E(a),disabled:n(w).pending||!y(a)||h(a)?.length===0,classes:n(R),color:"default",onClick:s=>z(a,s)},null,8,["model-value","indeterminate","disabled","classes","onClick"])):(d(),M(l,{key:1,modelValue:n(v),"onUpdate:modelValue":t[0]||(t[0]=s=>G(v)?v.value=s:null),disabled:n(w).pending,value:a,classes:n(R),color:"default",onClick:s=>z(a,s)},null,8,["modelValue","disabled","value","classes","onClick"]))],!0):C("",!0),u(e.$slots,"item-label",c(f({index:o,level:e.level,child:a,parent:e.parent,toggle:s=>{if("children"in a){n(p)[o]=!n(p)[o];return}z(a,s)},open:n(p)[o]})),()=>[$("span",null,D(a.item),1)],!0)])],!0),"children"in a?(d(),b(K,{key:0},[o in n(p)?ue((d(),b("div",we,[n(L)?(d(),b("div",{key:0,class:I(["absolute top-0 h-full w-[1px] border-l",e.classes?.treeline]),style:fe({left:n(L).offset})},null,6)):C("",!0),u(e.$slots,"children",c(f({index:o,level:e.level,child:a,parent:e.parent})),()=>[pe(m,{modelValue:n(v),"onUpdate:modelValue":t[1]||(t[1]=s=>G(v)?v.value=s:null),level:e.level+1,children:a.children,i18n:i.i18n,parent:a,icons:i.icons,treeline:i.treeline,classes:i.classes},{pending:g(s=>[u(e.$slots,"pending",c(f(s)),void 0,!0)]),"pending-label":g(s=>[u(e.$slots,"pending-label",c(f(s)),void 0,!0)]),"pending-icon":g(s=>[u(e.$slots,"pending-icon",c(f(s)),void 0,!0)]),empty:g(s=>[u(e.$slots,"empty",c(f(s)),void 0,!0)]),"empty-label":g(s=>[u(e.$slots,"empty-label",c(f(s)),void 0,!0)]),"empty-icon":g(s=>[u(e.$slots,"empty-icon",c(f(s)),void 0,!0)]),item:g(s=>[u(e.$slots,"item",c(f(s)),void 0,!0)]),"item-select":g(s=>[u(e.$slots,"item-select",c(f(s)),void 0,!0)]),"item-icon":g(s=>[u(e.$slots,"item-icon",c(f(s)),void 0,!0)]),"item-label":g(s=>[u(e.$slots,"item-label",c(f(s)),void 0,!0)]),children:g(s=>[u(e.$slots,"children",c(f(s)),void 0,!0)]),_:2},1032,["modelValue","level","children","i18n","parent","icons","treeline","classes"])],!0)],512)),[[ce,n(p)[o]]]):C("",!0)],64)):C("",!0)]))),128)):(d(),b("li",be,[u(e.$slots,"empty",c(f({level:e.level,parent:e.parent})),()=>[$("div",$e,[u(e.$slots,"empty-icon",c(f({level:e.level,parent:e.parent})),()=>[$("span",Ce,[n(k).empty?(d(),M(r,{key:0,name:n(k).empty,class:I([i.classes?.emptyIcon,"size-4"])},null,8,["name","class"])):C("",!0)])],!0),u(e.$slots,"empty-label",c(f({level:e.level,parent:e.parent})),()=>[$("span",null,D(i.i18n.empty),1)],!0)])],!0)]))])}}}),Ve=me(Ie,[["__scopeId","data-v-05ce8695"]]);export{Ve as _};
